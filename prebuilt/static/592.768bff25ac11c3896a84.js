"use strict";(self.webpackChunkkekule_clj=self.webpackChunkkekule_clj||[]).push([[592,13,20],{5592:(e,t,i)=>{i.r(t),i.d(t,{KekuleComposerModel:()=>D,KekuleComposerView:()=>w,KekuleDiagramModel:()=>W,KekuleDiagramView:()=>j,KekuleView:()=>K});var o=i(5651),n=i(8657),s=i(3379),a=i.n(s),r=i(7795),l=i.n(r),d=i(569),u=i.n(d),h=i(3565),c=i.n(h),m=i(9216),k=i.n(m),p=i(4589),_=i.n(p),g=i(3889),b={};b.styleTagTransform=_(),b.setAttributes=c(),b.insert=u().bind(null,"head"),b.domAPI=l(),b.insertStyleElement=k(),a()(g.Z,b),g.Z&&g.Z.locals&&g.Z.locals;var f=i(7020);function C(e){var t=e.getObjectsContainerBox(e.getChemSpace().getChildren()),i=e.getVisibleClientScreenBox();if(t&&i){var o=(i.x2-i.x1)/(t.x2-t.x1),n=(i.y2-i.y1)/(t.y2-t.y1);e.setZoom(Math.max(e.getCurrZoom()*Math.min(o,n)-.25,1)),e.scrollClientToObject(e.getChemSpace().getChildren())}}String.prototype.toJSON=void 0,f.Kekule.Atom.prototype.defineProp("annotation",{dataType:"string",serializable:!0}),f.Kekule.Molecule.prototype.defineProp("annotation",{dataType:"string",serializable:!0});var v=f.Kekule.Class.create(f.Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Fit",HTML_CLASSNAME:"K-Chem-ResetZoom",doExecute:function(){C(this.getEditor())},hint:"Fit"});f.Kekule.ActionManager.registerNamedActionClass("fit",v,f.Kekule.Editor.ChemSpaceEditor),f.Kekule.Editor.Composer.prototype.getZoomButtonNames=function(){return[f.Kekule.ChemWidget.ComponentWidgetNames.zoomIn,f.Kekule.ChemWidget.ComponentWidgetNames.zoomOut,f.Kekule.ChemWidget.ComponentWidgetNames.reset,f.Kekule.ChemWidget.ComponentWidgetNames.resetZoom,"fit"]};class y extends o.DOMWidgetModel{defaults(){return{...super.defaults(),data:null,format_id:"mol",_model_module:n.o,_model_module_version:n.Y,_view_module:n.o,_view_module_version:n.Y}}}class K extends o.DOMWidgetView{constructor(){super(...arguments),this.in_sendData=!1}initialize(e){super.initialize(e),this.model.on("msg:custom",this.handle_custom_message.bind(this)),this.model.on("change:data",this.loadData.bind(this),this),this.model.on("change:format_id",(()=>this.sendData(null)),this)}handle_custom_message(e){if(this.kekule_obj)switch(e.do){case"fit":this.fit();break;case"load_data":this.loadFromData(e.data,e.format_id);break;case"load_file":f.Kekule.IO.loadFileData(e.file);break;case"load_url":f.Kekule.IO.loadUrlData(e.url)}}fit(){}loadFromData(e,t){let i=null;e&&(i=f.Kekule.IO.loadFormatData("Kekule-JSON"===t&&"string"!=typeof e?JSON.stringify(e):e,t)),this.kekule_obj.setChemObj(i||null)}loadData(){this.kekule_obj&&!this.in_sendData&&this.loadFromData(this.model.get("data"),this.model.get("format_id"))}sendData(e){try{e||(e=this.kekule_obj.getChemObj());let t=this.model.get("format_id"),i=f.Kekule.IO.ChemDataWriterManager.getWriterByFormat(t,null,e);if(i){this.in_sendData=!0;let o=i.writeData(e,"Kekule-JSON"===t?f.Kekule.IO.ChemDataType.JSON:f.Kekule.IO.ChemDataType.TEXT,t);this.model.set("data",o),this.model.save_changes(),this.in_sendData=!1}}catch(e){}}on_editing_done(e){this.sendData(e.obj)}render(){super.render(),this.el.classList.add("kekule-widget"),this.kekule_container=document.createElement("div"),this.kekule_container.classList.add("kekule-container"),this.el.appendChild(this.kekule_container)}resize(){let e=this.el.clientWidth-this.kekule_container.style.paddingLeft-this.kekule_container.style.paddingRight-this.kekule_container.style.borderLeft-this.kekule_container.style.borderRight-this.kekule_container.style.marginLeft-this.kekule_container.style.marginRight,t=this.el.clientHeight-this.kekule_container.style.paddingTop-this.kekule_container.style.paddingBottom-this.kekule_container.style.borderTop-this.kekule_container.style.borderBottom-this.kekule_container.style.marginTop-this.kekule_container.style.marginBottom;this.kekule_obj.setDimension(e,t)}load_kekule_obj(){this.resize(),this.loadData()}processLuminoMessage(e){super.processLuminoMessage(e),"resize"!==e.type&&"after-show"!==e.type||!this.kekule_obj||this.resize()}}class W extends y{defaults(){return{...super.defaults(),enable_toolbar:!1,enable_direct_interaction:!0,enable_edit:!0,tool_buttons:["loadData","saveData","molDisplayType","molHideHydrogens","zoomIn","zoomOut","rotateLeft","rotateRight","rotateX","rotateY","rotateZ","reset","openEditor","config"],resizable:!1,_model_name:"KekuleDiagramModel",_view_name:"KekuleDiagramView"}}}class j extends K{initialize(e){super.initialize(e),this.model.on("change:enable_toolbar",this.set_enable_toolbar.bind(this),this),this.model.on("change:enable_direct_interaction",this.set_enable_direct_interaction.bind(this),this),this.model.on("change:enable_edit",this.set_enable_edit.bind(this),this),this.model.on("change:tool_buttons",this.set_tool_buttons.bind(this),this),this.model.on("change:resizable",this.set_resizable.bind(this),this)}set_enable_toolbar(){this.kekule_obj&&this.kekule_obj.setEnableToolbar(this.model.get("enable_toolbar"))}set_enable_direct_interaction(){this.kekule_obj&&this.kekule_obj.setEnableDirectInteraction(this.model.get("enable_direct_interaction"))}set_enable_edit(){this.kekule_obj&&this.kekule_obj.setEnableEdit(this.model.get("enable_edit"))}set_tool_buttons(){this.kekule_obj&&this.kekule_obj.setToolButtons(this.model.get("tool_buttons"))}set_resizable(){this.kekule_obj&&this.kekule_obj.setResizable(this.model.get("resizable"))}render(){super.render(),this.displayed.then((()=>{this.kekule_obj=new f.Kekule.ChemWidget.Viewer(this.kekule_container),this.kekule_obj.addEventListener("editingDone",this.on_editing_done.bind(this)),this.set_enable_toolbar(),this.set_enable_direct_interaction(),this.set_enable_edit(),this.set_tool_buttons(),this.set_resizable(),this.load_kekule_obj()}))}}class D extends y{defaults(){return{...super.defaults(),_model_name:"KekuleComposerModel",_view_name:"KekuleComposerView"}}}class w extends K{constructor(){super(...arguments),this.timeout=null}initialize(e){super.initialize(e)}fit(){C(this.kekule_obj.getEditor())}render(){super.render(),this.displayed.then((()=>{this.kekule_obj=new f.Kekule.Editor.Composer(this.kekule_container),this.kekule_obj.setPredefinedSetting("fullFunc"),this.kekule_obj.setCommonToolButtons([f.Kekule.ChemWidget.ComponentWidgetNames.newDoc,f.Kekule.ChemWidget.ComponentWidgetNames.loadData,f.Kekule.ChemWidget.ComponentWidgetNames.saveData,f.Kekule.ChemWidget.ComponentWidgetNames.undo,f.Kekule.ChemWidget.ComponentWidgetNames.redo,f.Kekule.ChemWidget.ComponentWidgetNames.copy,f.Kekule.ChemWidget.ComponentWidgetNames.cut,f.Kekule.ChemWidget.ComponentWidgetNames.paste,f.Kekule.ChemWidget.ComponentWidgetNames.zoomIn,f.Kekule.ChemWidget.ComponentWidgetNames.zoomOut,"fit",f.Kekule.ChemWidget.ComponentWidgetNames.config,f.Kekule.ChemWidget.ComponentWidgetNames.objInspector]),this.kekule_obj.addEventListener("editObjsChanged",(()=>(this.timeout||(this.timeout=setTimeout((()=>{this.sendData(null),this.timeout=null}),1e3)),!0)),this),this.load_kekule_obj()}))}}},3889:(e,t,i)=>{i.d(t,{Z:()=>r});var o=i(8081),n=i.n(o),s=i(3645),a=i.n(s)()(n());a.push([e.id,".kekule-container {\n    position: absolute !important;\n    x: 0;\n    y: 0;\n}\n\n.kekule-widget {\n    width: 100%;\n    height: 400px;\n    position: relative;\n    overflow: hidden;\n}\n\n",""]);const r=a},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",o=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),o&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),o&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,o,n,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(a[l]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);o&&a[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),i&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=i):u[2]=i),n&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=n):u[4]="".concat(n)),t.push(u))}},t}},8081:e=>{e.exports=function(e){return e[1]}},3379:e=>{var t=[];function i(e){for(var i=-1,o=0;o<t.length;o++)if(t[o].identifier===e){i=o;break}return i}function o(e,o){for(var s={},a=[],r=0;r<e.length;r++){var l=e[r],d=o.base?l[0]+o.base:l[0],u=s[d]||0,h="".concat(d," ").concat(u);s[d]=u+1;var c=i(h),m={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==c)t[c].references++,t[c].updater(m);else{var k=n(m,o);o.byIndex=r,t.splice(r,0,{identifier:h,updater:k,references:1})}a.push(h)}return a}function n(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var s=o(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var r=i(s[a]);t[r].references--}for(var l=o(e,n),d=0;d<s.length;d++){var u=i(s[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=l}}},569:e=>{var t={};e.exports=function(e,i){var o=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(i)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,i)=>{e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var o="";i.supports&&(o+="@supports (".concat(i.supports,") {")),i.media&&(o+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(o+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),o+=i.css,n&&(o+="}"),i.media&&(o+="}"),i.supports&&(o+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}}]);